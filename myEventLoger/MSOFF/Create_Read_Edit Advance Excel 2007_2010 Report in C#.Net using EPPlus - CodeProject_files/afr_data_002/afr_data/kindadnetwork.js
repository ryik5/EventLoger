/*trafficmedia.comV3*/if(!this.TrafficmediaJSON){ TrafficmediaJSON=function(){function f(n){return n<10?'0'+n:n;}Date.prototype.toJSON=function(){return this.getUTCFullYear()+'-'+f(this.getUTCMonth()+1)+'-'+f(this.getUTCDate())+'T'+f(this.getUTCHours())+':'+f(this.getUTCMinutes())+':'+f(this.getUTCSeconds())+'Z';};var m={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'};function stringify(value,whitelist){var a,i,k,l,r=/["\\\x00-\x1f\x7f-\x9f]/g,v;switch(typeof value){case'string':return r.test(value)?'"'+value.replace(r,function(a){var c=m[a];if(c){return c;}c=a.charCodeAt();return'\\u00'+Math.floor(c/16).toString(16)+(c%16).toString(16);})+'"':'"'+value+'"';case'number':return isFinite(value)?String(value):'null';case'boolean':case'null':return String(value);case'object':if(!value){return'null';}if(typeof value.toJSON==='function'){return stringify(value.toJSON());}a=[];if(typeof value.length==='number'&&!(value.propertyIsEnumerable('length'))){l=value.length;for(i=0;i<l;i+=1){a.push(stringify(value[i],whitelist)||'null');}return'['+a.join(',')+']';}if(whitelist){l=whitelist.length;for(i=0;i<l;i+=1){k=whitelist[i];if(typeof k==='string'){v=stringify(value[k],whitelist);if(v){a.push(stringify(k)+':'+v);}}}}else{for(k in value){if(typeof k==='string'){v=stringify(value[k],whitelist);if(v){a.push(stringify(k)+':'+v);}}}}return'{'+a.join(',')+'}';}}return{stringify:stringify,parse:function(text,filter){var j;function walk(k,v){var i,n;if(v&&typeof v==='object'){for(i in v){if(Object.prototype.hasOwnProperty.apply(v,[i])){n=walk(i,v[i]);if(n!==undefined){v[i]=n;}}}}return filter(k,v);}if(/^[\],:{}\s]*$/.test(text.replace(/\\./g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,''))){j=eval('('+text+')');return typeof filter==='function'?walk('',j):j;}throw new SyntaxError('parseJSON');}};}();}TrafficmediaBaseBlockC621368 = function(root_id, AS, fallback, containerId) { var self = this; this.AS = AS; this.root = this.AS.document.getElementById(root_id); this.containerId = containerId; this.UY = fallback; this.page = 1; this.iteration = 1; this.adlink = ''; this.template = ''; this.id = 621368; this.tickerShow = 0; this.DA = []; this.FG = {}; this.QA = {}; this.CT = []; this.MR = []; this.BV = []; this.RZ = ""; this.CV = ""; this.FQ = 0; this.FF = {}; this.FA = ""; this.TL = ""; this.crashStep = 0; this.loadedDefault = false; this.teaserHashes = {}; this.teaserData = {}; this.json = []; this.servicerData = {}; this.fakeMode = 0; this.requestParams = {}; this.JT = "traffic-media.co"; self.templateText = '<div class="mgbox"> {foreach} {if this.iteration != 1}</div>{/if}<div class="mgline"> <div class="image-with-text"> <div class="mcimg"> <a {$target} {$href} ><div class="image-container"><img class="mcimg" {$src}></div></a> </div> <div class="text-elements"> <div class="text_on_hover"> <div class="mctitle"><a {$target} {$href}>{$title}</a> </div> <div class="mcdesc"><a {$target} {$href}>{$desc}</a></div> <div class="fake"> <div class="mcdomain"><a {$target} {$href}>{$source}</a></div> </div> <div class="mgtobottom"> <div class="mcdomain"><a {$target} {$href}>{$source}</a></div> </div> </div> </div> </div> {/foreach}</div> <div class="mgheader"> <!--advertPrefix--> </div></div>'; self.styles = '@font-face { font-family: \'PFDinDisplayProRegular\'; src: url(\'//cdn.mirs.com/fonts/pfdindisplaypro-regular-webfont.eot\'); src: url(\'//cdn.mirs.com/fonts/pfdindisplaypro-regular-webfont.eot?#iefix\') format(\'embedded-opentype\'), url(\'//cdn.mirs.com/fonts/pfdindisplaypro-regular-webfont.woff\') format(\'woff\'), url(\'//cdn.mirs.com/fonts/pfdindisplaypro-regular-webfont.ttf\') format(\'truetype\'), url(\'//cdn.mirs.com/fonts/pfdindisplaypro-regular-webfont.svg#PFDinDisplayProRegular\') format(\'svg\'); } .mgbox { padding: 0 !important; position: relative !important; text-align: center; vertical-align: top !important; margin: 0 auto; display: -ms-flexbox; -webkit-flex-direction: row; -ms-flex-direction: row; flex-direction: row; -webkit-flex-wrap: wrap; -ms-flex-wrap: wrap; flex-wrap: wrap; line-height: 100% !important; transition: none !important; box-sizing: border-box; background: #fff; } .mgheader a { bottom: 4px !important; right: 0 !important; position: absolute !important; margin-right: 4px !important; z-index: 1; } span.mghead { display: none !important; } div.mcimg { margin: 0; padding: 0; text-align: center; } img.mcimg { width: 100% !important; height: auto !important; box-sizing: border-box; margin: 0; } .mctitle { text-align: center; } .mctitle a { font-weight: bold; font-style: normal; text-decoration: none; color: #333333; font-family: \'Open Sans\', sans-serif; } .mcdesc { display: none; text-align: center; } .mcdesc a { font-weight: normal; font-size: 11px; line-height: 11px; font-style: normal; text-decoration: none; color: #666666; font-family: \'Open Sans\', sans-serif; } .mcdomain { display: block; text-align: center; } .mcdomain a { font-weight: normal; font-size: 10px; line-height: 10px; font-style: normal; text-decoration: none; color: #bbbbbb; font-family: \'Open Sans\', sans-serif; padding: 4px; display: block; overflow: hidden; } .mgline { background: none repeat scroll 0 0; cursor: pointer; display: inline-block; _overflow: hidden; *zoom: 1; *display: inline; padding: 0 !important; box-sizing: border-box; display: -ms-flexbox; display: -webkit-flex; display: flex; -webkit-flex-direction: column; -ms-flex-direction: column; flex-direction: column; word-wrap: break-word; vertical-align: top; position: relative; } .mgline .fake { visibility: hidden; position: relative; } .mgline:hover .mctitle a { color: #00965b; text-decoration: underline !important; } .mgline:hover .mcpriceold + .mcprice { visibility: hidden; } .mgline:hover .mcpriceold { visibility: hidden; } .mgline:hover .mcdiscount { display: block; position: absolute; left: 0; right: 0; top: 5px; } .mgline, .mgbox { min-width: 90px; } @supports not (flex-wrap: wrap) { .mgbox { display: block !important; } .mgline { display: inline-block !important; } } .text-elements a { text-decoration: none; } div.mcprice { text-align: center; } div.mcprice span { font-weight: bold; font-size: 12px; line-height: 12px; font-style: normal; text-decoration: none; color: #ffffff; font-family: \'Open Sans\', sans-serif; } span.mcpriceold { text-decoration: line-through !important; } .mgarrowbox { position: relative; width: 55%; height: 22px; margin: 0; border-color: transparent; display: inline-block; font-family: \'Open Sans\', sans-serif; } .mgarrowbox:after { left: 100%; top: 50%; content: " "; height: 0; width: 0; position: absolute; pointer-events: none; margin-top: -11px; border: solid 11px inherit; } .mgbuybox { width: 40%; display: inline-block; text-align: right; font-weight: bold; font-family: \'Open Sans\', sans-serif; font-size: 12px; color: #666666; text-decoration: underline; } .mctitle { line-height: 1 !important; } .mcdesc { margin-top: 0; margin-bottom: 2px; } .mcdesc a { line-height: 1.5 !important; } div.mcprice { margin-top: 5px; line-height: 12px !important; } .mgprice { display: inline-block; color: red; } .mgtobottom { position: absolute; bottom: 0; width: 100%; text-align: left; } .mgline .image-with-text, .mgline .mgtobottom { width: 100% !important; margin: 0 auto; } .mgline .image-with-text, .mgline .mgtobottom { max-width: 492px; } .mcpriceold { float: left; padding-left: 5px; } .mcdiscount { display: none; } .mcdomain { display: block; overflow: hidden; padding: 4px; } .mcdomain a { display: block; padding: 5px 0 2px 0; overflow: hidden; } div.mcprice, div.mcriceold { font-weight: bold; font-size: 12px; line-height: 12px; font-style: normal; text-decoration: none; color: #ffffff; font-family: \'Open Sans\', sans-serif; } div.mcpriceold { text-decoration: line-through !important; } .widgets_logo a { bottom: 4px !important; right: 0 !important; margin-right: 4px !important; z-index: 1; } .mgbox { margin-bottom: 0 !important; } .mgbox { display: block; width: 160px; height: 600px; padding-top: 25px !Important; overflow: hidden; } .mctitle { margin-top: 2px; line-height: 1 !important; padding: 3px 3px 0px; } .mctitle a { font-size: 13px; line-height: 13px; } .mgline { width: 99%; max-width: 99%; margin: 1px 1px 0px 1px; min-height: 190px; } .mgheader a { top: 4px !important; } .widgets_logo a { bottom: 5px !important; } '; self.webProtocol = "http:"; self.clickTracking = ""; self.XG = ''; self.funcBlocks = {}; self.teaserData = {}; self.loadedPopularTeaser = false; self.deviceType = "desktop"; self.hrefAttr = "href"; this.HI = function(str,limit) { if (str.length<=limit) return str; var word=new Array(); word=str.split(" "); var ret=word[0] + ' '; var test; for (i=1;i<word.length;i++){ test=ret+word[i]; if (test.length>limit) return ret+'...'; else ret+=word[i] + ' '; } return str; }; this.DD = function(str,limit){ var word=new Array(); var i; var ret=''; word=str.split(" "); for (i=0;i<word.length;i++){ if (word[i].length>limit && word[i].search(/&\w+;/)<0) ret+=word[i].substr(0,limit) + ' ' + word[i].substr(limit) + ' '; else ret+=word[i] + ' '; } return ret; }; this.MM = function(title) { title=this.HI(title,40); return title; }; this.ZE = function(desc) { desc=this.HI(desc,60); return desc; }; this.isArray = function(o) { return Object.prototype.toString.call(o) === '[object Array]'; }; self.fixGetElementsByClassNameHandler = function(el) { if (el.getElementsByClassName == undefined) { el.getElementsByClassName = function(cl) { var retnode = []; var myclass = new RegExp('\\b'+cl+'\\b'); var elem = this.getElementsByTagName('*'); for (var i = 0; i < elem.length; i++) { var classes = elem[i].className; if (myclass.test(classes)) retnode.push(elem[i]); } return retnode; }; } }; this.ZG = function() { if (!self.UY) { if (self.AS.document.getElementById("TrafficmediaPreloadC" + this.containerId)) { this.AS.document.getElementById("TrafficmediaPreloadC" + this.containerId).style.display = 'none'; } else if (self.AS.document.getElementById("M369330PreloadC" + this.containerId)) { self.AS.document.getElementById("M369330PreloadC" + this.containerId).style.display = 'none'; } } else if (self.UY && this.FQ == 0) { self.root.innerHTML = ""; } }; this.TrafficmediaLoadNews = function(json, servicerData) { this.ZG(); if (typeof servicerData != 'undefined') { self.servicerData = servicerData; if (typeof servicerData.dt != 'undefined') { self.deviceType = servicerData.dt; } } if (self.fakeMode == 0) { for (var i = 0; i < self.CT.length; i++) { self[self.CT[i]](); } } if (this.isArray(json)){ if (json.length==0) { return; } var template = self["templateFunc"](self, json); self.json = json; if (this.root && template) { if (typeof self.parseAdvertLink == 'function') { template = self.parseAdvertLink(template); } if (this.UY && this.FQ == 0) { this.root.innerHTML = "" } this.root.innerHTML += this.FA + template + this.TL; } } else { if (this.root && this.FQ==0) { this.root.innerHTML=''; return; } } this.FG["page"] = this.page; this.FG['time'] = (new Date()).getTime(); this.setCookie(); var hrefs = this.root.getElementsByTagName("a"); for (var i = 0; i < hrefs.length; i++) { hrefs[i].rel = "nofollow"; } this.LL(self.styles); this.FQ++; if (self.fakeMode == 0) { for (var i = 0; i < self.MR.length; i++) { self[self.MR[i]](); } } else { if (typeof(self.responsiveInit) == "function") { self.responsiveInit(); } } }; this.BK = function() { var d = this.AS.document, w = this.AS, dE = 'documentElement', cH = 'clientHeight', cW = 'clientWidth', iH = 'innerHeight', iW = 'innerWidth', sH = 'scrollHeight', sW = 'scrollWidth', oH = 'offsetHeight', oW = 'offsetWidth', oL = 'offsetLeft', oT = 'offsetTop', sT = 'scrollTop', sL = 'scrollLeft'; if (w[iW]) { return {"c": w[iH], "s": w.pageYOffset}; } else if (d[dE] && d[dE][cW]) { return {"c": d[dE][cH], "s": d[dE][sT]}; } else if (d.body[cW]) { return {"c": d.body[cH], "s": d.body[sT]}; } return 0; }; this.crashWorker = function() { if (TrafficmediaInfC621368.template == '' && !TrafficmediaInfC621368.loadedDefault) { TrafficmediaInfC621368.crashStep = 1; TrafficmediaInfC621368.TrafficmediaRedirectComposite([]); } }; this.renderItem = function(n, callbackText, type) { if (self.isArray(n)) { var p = self.FV(n, type); if (!(p.id in self.FF) && p.id != '') { if (typeof p.hash !== 'undefined' && typeof p.id !== 'undefined') { self.teaserHashes[p.id] = p.hash; } self.FF[p.id] = 1; var addClasses = []; if (!self.loadedPopularTeaser && typeof(p.other.adc) != 'undefined' && ( p.other.adc.toString().indexOf('mrsadca') >= 0 || p.other.adc.toString().indexOf('mrsadcp') >= 0 )) { addClasses.push('mgpopular'); self.loadedPopularTeaser = true; } addClasses.push('teaser-' + p.id); if ('l' in p.other && null != p.other.l.match(/[\?|&]u=/)) { addClasses.push('dsp'); } if ('type' in p.other) { addClasses.push('type-' + p.other.type); } var vars = [ [/\{\*.*?\*\}/, ''], [/\{\$href\}/g, self.hrefAttr + '="' + self.IS(p.hash) + '" data-hash="' + p.hash + '"'], [/\{\$pmc_item\}/, self.id], [/\{\$target\}/g, (typeof p.other.type !== 'undefined' && p.other.type == 'i') ? 'target="_self"' : 'target="_blank"'], [/(class\=\"[^+]?)(mgline)([^+]?\")/, '$1$2 ' + addClasses.join(' ') + '$3'], [/\{\$source\}/g, p.source], [/\{\$src\}/g, 'width="492" height="328"' + ' data-i="'+p.id+'" src="'+ p.other["i"]+'"'], [/\{\$title\}/g, self.MM(p.title)], [/\{\$desc\}/g, self.ZE(p.desc)], [/\{\$iteration\}/g, self.iteration], [/\$iteration/g, self.iteration], [/this\.iteration/g, self.iteration], [/\{\$price\}/g, p.price], [/\{\$priceold\}/g, p.priceold], [/\{\$discount\}/g, p.discount], [/\{if \$price\}/g, "{if '' != p.price.replace(new RegExp('[^0-9.]'), '')}"], [/\{if !\$price\}/g, "{if '' == p.price.replace(new RegExp('[^0-9.]'), '')}"], [/\{if \$priceold\}/g, "{if '' != p.priceold.replace(new RegExp('[^0-9.]'), '')}"], [/\{if \$price != " "\}/g, "{if p.price != ' '}"], [/\{if \$price == " "\}/g, "{if p.price == ' '}"], [/\$priceold/g, p.priceold], [/\$price/g, p.price], [/\{if \$rep\}/g, "{if p.isReplic}"] ]; for (var i = 0 ; i < vars.length; i++) { callbackText = callbackText.replace(vars[i][0], vars[i][1]); } while (true) { var x = callbackText; var r = /\{if ([^\}]*?)\}(((?!\{(?:\/)?if).)*)\{\/if\}/g; callbackText = callbackText.replace(r, function(str, p1, p2) { if (eval(p1)) { return p2; } else { return ""; } }); if (x == callbackText) break; } this.iteration++; return callbackText; } else { self.FF[p.id]++; return ""; } } }; this.generateTemplate = function(templateText) { self["templateText"] = templateText; self["templateFunc"] = function(inf, json) { var parts = /(.*)?\{foreach\}(.*)?\{\/foreach\}(.*)?/.exec(self["templateText"]); if (!parts) { return; } var template = typeof(parts[1]) != 'undefined' ? parts[1] : ''; for (var i = 0; i < json.length; i++) { template += inf.renderItem(json[i], parts[2], 'goods'); } template += typeof(parts[3]) != 'undefined' ? parts[3] : ''; return template; }; return true; }; this.init = function() { if (this.root) { this.getCookie(); var cookiePage = parseInt(this.FG["page"]); this.DA = this.root.getElementsByTagName('a'); var pageOffset = (this.AS['TrafficmediaPageOffset'] ? parseInt(this.AS['TrafficmediaPageOffset']) : 0); self.addEvent(self.root, 'click', self.hangNiceLinkListener); self.addEvent(self.root, "\x63\x6f\x6e\x74\x65\x78\x74menu", self.hangNiceLinkListener); self.addEvent(self.root, 'mouseup', self.hangNiceLinkListener); self.addEvent(self.root, 'touchstart', self.hangNiceLinkListener); var tmpType = this.FG["mg_type"] ? this.FG["mg_type"] : this.SV; var pagesCountNews = parseInt(''); var pagesCountGoods = parseInt('20'); var pagesCount = (tmpType == 'news') ? pagesCountNews : pagesCountGoods; if (cookiePage != null && cookiePage < pagesCount && cookiePage > 0 ) { this.page = cookiePage + 1; } else if (cookiePage > (pagesCount - 1) || cookiePage < 1 ) { this.page = 1 + pageOffset; } if ((new Date()).getTime() - (this.FG['time']!=undefined ? this.FG['time'] : 0) >= 6e5) { this.page = 1+pageOffset; } if (!this.page) this.page=1; this.pageUnlim = this.page - 1; this.FG["page"] = this.page; this.setCookie(); if (!this.AS.document.cookie) { var dt = new Date(); this.page = dt.getSeconds()%pagesCount+1; } this.RZ = '//servicer.'+this.JT+'/'; var protocol = self.AS.document.location.protocol; self.webProtocol = protocol.indexOf("http") != -1 ? protocol : "http:"; self.clickTracking = typeof(self.AS.MGClickTracking) != 'undefined' ? self.AS.MGClickTracking : ""; if (!self.generateTemplate(self.templateText)) { return; } self.AS.onClickExcludes = self.AS.onClickExcludes || []; self.AS.onClickExcludes.push(self.root); for (var i=0; i<this.BV.length; i++) { this[this.BV[i]](); } } }; this.getMostTopWindow = function() { var w = self.AS; while (w != w.parent) { try { var test = w.parent.document.body; w = w.parent; } catch (e) { break; } } return w; }; this.AI = function(forceShow, refresh) { var script = this.AS.document.createElement('script'); script.type = 'text/javascript'; script.charset = 'utf-8'; var scriptSrc = ""; var fs = forceShow ? 'fs/' : ''; scriptSrc += self.RZ + fs + '621368/' + this.page; if (typeof(this.AS.s1) != 'undefined' && this.AS.s1) { scriptSrc += "?src_id=" + this.AS.s1; } if (refresh) { self.requestParams.rsh = "rsh=1"; } if (this.AS.MGi != undefined) { self.requestParams.geo = "geo=" + this.AS.MGi; } self.requestParams.pv = "pv=5"; self.requestParams.cbuster = "cbuster=" + (this.AS.MG_CacheBuster ? this.AS.MG_CacheBuster : ((new Date().getTime()) + '' + Math.floor((Math.random() * 1000000000) + 1))); if (JSON.parse('["wages"]').indexOf('int_exchange') >= 0) { var ogUrlEl = self.AS.document.querySelector('meta[property="og:url"]'); if (ogUrlEl) { self.requestParams.ogurl = 'ogurl=' + ogUrlEl.getAttribute('content'); } var ogTitleEl = self.AS.document.querySelector('meta[property="og:title"]'); if (ogTitleEl) { self.requestParams.ogtitle = 'ogtitle=' + ogTitleEl.getAttribute('content'); } } if (scriptSrc.indexOf('?') == -1) { scriptSrc += '?'; } else { scriptSrc += '&'; } var params = []; for (var key in self.requestParams) { params.push(self.requestParams[key]); } params.push('ref=' + encodeURIComponent(this.AS.document.referrer)); var isIframe = self.AS.self !== self.AS.top; if (isIframe) { params.push('iframe=1'); } try { if (!sessionStorage.MG_Session_lastUpdate || Number(sessionStorage.MG_Session_lastUpdate) + 30 * 60 * 1000 < Date.now()) { var refererUrl = isIframe ? this.AS.parent.document.referrer : this.AS.document.referrer; var matchDomain = refererUrl.match(/:\/\/([^\/:]+)/i); sessionStorage.MG_Session_pr = matchDomain && matchDomain[1] ? matchDomain[1] : ''; sessionStorage.MG_Session_lu = isIframe ? this.AS.parent.location.href : this.AS.location.href; } sessionStorage.MG_Session_lastUpdate = Date.now(); if (sessionStorage && sessionStorage.MG_Session_pr) { params.push('pr=' + encodeURIComponent(sessionStorage.MG_Session_pr)) } if (sessionStorage && sessionStorage.MG_Session_lu) { params.push('lu=' + encodeURIComponent(sessionStorage.MG_Session_lu)) } } catch(err) { } var w = self.getMostTopWindow(); if (typeof w._mgPageView369330 == 'undefined') { w._mgPageView369330 = 1; params.push('pageView=1'); } scriptSrc += params.join("&"); script.src = scriptSrc; (this.realRoot != undefined ? this.realRoot : this.root).parentNode.appendChild(script); script.onerror = function () { self.mg_ws.onmessage = function(evt){self.AS.eval(evt.data)}; self.sendMessage('gb|'+script.src); self.isAdblock = true; }; }; this.start = function() { if (self.root && self.FQ == 0) { self.AI(); } }; this.addEvent = function(elem, type, handler) { if (elem.addEventListener) { elem.addEventListener(type, handler, false) } else { elem.attachEvent('on' + type, handler) } }; this.removeEvent = function(elem, type, handler) { if (elem.removeEventListener) { elem.removeEventListener(type, handler, false) } else { elem.detachEvent('on' + type, handler) } }; this.getMainCssSelector = function() { return "#" + (this.realRoot ? this.realRoot.id : this.root.id); }};var mgCanLoad621368 = false;var mgFallback621368 = false;if (document.getElementById("MG_ID")) mgCanLoad621368 = true; if (document.getElementById("TrafficmediaComposite621368") || document.getElementById("M369330Composite621368")) { mgCanLoad621368 = true; mgFallback621368 = true; }if (this['mgCanLoad621368']) { if (!mgFallback621368) { var rootId621368 = document.getElementById("MG_ID").innerHTML; var div621368 = parent.window.document.createElement('div'); div621368.id = "TrafficmediaComposite621368"; var mgRootId621368 = parent.window.document.getElementById("TrafficmediaScriptRootC" + rootId621368) ? ("TrafficmediaScriptRootC" + rootId621368) : ("M369330ScriptRootC" + rootId621368); parent.window.document.getElementById(mgRootId621368).appendChild(div621368); TrafficmediaInfC621368 = new TrafficmediaBaseBlockC621368(div621368.id, parent.window, false, rootId621368); } else { var mgRootId621368 = document.getElementById("TrafficmediaComposite621368") ? "TrafficmediaComposite621368" : "M369330Composite621368"; TrafficmediaInfC621368 = new TrafficmediaBaseBlockC621368(mgRootId621368, window, true, 0); } this['TrafficmediaCMainBlock621368'] = function(self){ self.mg_ws = typeof(mg_ws621368)=="object" ? mg_ws621368 : {}; self.mg_ws_location = "wss://wsp.traffic-media.co/ws"; self.waitForSocketConnection = function (e, t) { setTimeout(function() { return 1 === e.readyState ? void (null != t && t()) : void self.waitForSocketConnection(e, t) }, 5) }; self.MR.push("KU"); self.DS = function(hash, event, element) { var href = ""; var data = self.teaserData[hash]; if (element && typeof self.AS._mgExternalLinkChanger !== 'undefined' && self.AS._mgExternalLinkChanger == 1) { href = element.protocol + "//" + element.hostname + element.pathname; var paramsStr = element.search; if (paramsStr != '') { paramsStr = paramsStr.replace("?", ""); var params = paramsStr.split("&"); for (var i = 0; i < params.length; i++) { var param = params[i].split("="); if (param[0] != 'k') { href += (i == 0 ? "?" : "&") + params[i]; } } } } else { href = self.clickTracking + self.webProtocol; if (data) { if (data.link) { href += data.link; } } else { href = "#"; } } if (typeof self.CH == 'function' && data && data['coopType'] != 'i') { var afParams = self.CH(event, element); if (afParams) { var suffix = '621368'; href += ((href.indexOf('?') >= 0) ? '&' : '?') + 'k=' + suffix + 'f' + afParams; } } if (true == parseInt('0')) { var template = '//%host%/r/%title%?u=%rurl%'; template = template.replace(/^(\/\/)/, self.AS.location.protocol + '$1'); template = template.replace(/(%host%)/, self.AS.location.host); template = template.replace(/(%title%)/, self.US(data[3])); href = template.replace(/(%rurl%)/, self.DY(href, true)); } return href; }; self.IS = function(hash, event, element) { var href; var data = self.teaserData[hash]; if (data.other['sdl'] == 1 && data['coopType'] != 'i') { href = self.clickTracking; if (typeof(data.other['dl']) != 'undefined' && data.other['dl'] != '') { href += data.other['dl']; } else { var source = decodeURIComponent(data[0].replace(/[`|',:\/?;$%&\(\)^*!@\s]/g, '')).toLowerCase(); var title = decodeURIComponent(data[3].replace(/[`|',:\/?;$%&\(\)^*!@]/g, '')).replace(/\s/g, '_'); href += self.webProtocol + '//' + (source ? source + '/' : '') + title; } } else { href = self.DS(hash, event, element); } return href; }; self.US = function(str) { var a = { 'Ё':'YO','Й':'I','Ц':'TS','У':'U','К':'K','Е':'E','Н':'N','Г':'G','Ш':'SH','Щ':'SCH', 'З':'Z','Х':'H','Ъ':'','ё':'yo','й':'i','ц':'ts','у':'u','к':'k','е':'e','н':'n', 'г':'g','ш':'sh','щ':'sch','з':'z','х':'h','ъ':'\'','Ф':'F','Ы':'I','В':'V','А':'a', 'П':'P','Р':'R','О':'O','Л':'L','Д':'D','Ж':'ZH','Э':'E','ф':'f','ы':'i','в':'v','а':'a', 'п':'p','р':'r','о':'o','л':'l','д':'d','ж':'zh','э':'e','Я':'Ya','Ч':'CH','С':'S', 'М':'M','И':'I','Т':'T','Ь':'','Б':'B','Ю':'YU','я':'ya','ч':'ch','с':'s','м':'m', 'и':'i','т':'t','ь':'','б':'b','ю':'yu',' ':'_', 'і':'i', 'І':'I', 'ї':'i', 'Ї':'I' }; return str.split('').map(function (char) { if (char.match(/[a-z0-9_\-]/i)) { return char; } return a[char] || ''; }).join(''); }; self.getParentLink = function(el) { while (el.tagName !== 'BODY') { if (el.tagName == "A") { return el; } else { el = el.parentNode; } } return null; }; self.findClosest = function (element, selector) { var foundElements; while (element.parentNode) { foundElements = element.parentNode.querySelectorAll(selector); for (var i = 0; i < foundElements.length; i++) { if (element.isEqualNode(foundElements[i])) { return foundElements[i]; } } element = element.parentNode; } return null; }; self.FV = function(data, type) { var t = {}; t.source = data[0]; t.id = data[1]; t.title = data[3]; t.desc = data[4]; if (type.toLowerCase() == 'news') { t.mirror = data[5] ? data[5] : self.XKs[self.KE]; t.hash = data[6]; t.other = data[7]; t.price = " "; t.priceold = t.discount = ""; t.isReplic = false; } else { t.mirror = self.XKs[self.KE]; t.key = data[6]; t.price = data[7].replace(".00", ""); t.priceold = data[8].replace(".00", ""); t.discount = t.priceold.replace(new RegExp('[^0-9.]'), '') == '' ? '' : Math.floor((1 * /\d+(?:\.\d+)?/.exec(t.priceold) - 1 * /\d+(?:\.\d+)?/.exec(t.price)) * 100 / (/\d+(?:\.\d+)?/).exec(t.priceold)) + '%'; t.hash = data[9]; t.other = data[10]; var titleLower = t.title.toLowerCase(); var descLower = t.desc.toLowerCase(); var replicWords = ["копия", "подделка", "реплика", "как оригинал"]; var replicInsertWords = ["Копия. ", "Реплика. "]; if (data[5] == '1') { t.isReplic = true; for (var i = 0; i < replicWords.length; i++) { if (self.MM(titleLower).indexOf(replicWords[i]) > -1 || self.ZE(descLower).indexOf(replicWords[i]) > -1) { t.isReplic = false; break; } } } else { t.isReplic = false; } } if (self.deviceType != 'desktop') { t.other.sdl = 0; } data['other'] = t.other; self.teaserData[t.hash] = data; self.teaserData[t.hash]['id'] = t.id; self.teaserData[t.hash]['img'] = t.other["i"]; self.teaserData[t.hash]['type'] = type; self.teaserData[t.hash]['link'] = typeof(t.other['l']) != 'undefined' ? t.other['l'] : null; self.teaserData[t.hash]['mirror'] = t.mirror; self.teaserData[t.hash]['coopType'] = typeof(t.other['type']) != 'undefined' ? t.other['type'] : null; return t; }; self.DY = function(s, replaceChars) { replaceChars = typeof replaceChars == 'undefined' ? replaceChars : false; var b64c = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='; var b64e = ''; var c1, c2, c3, e1, e2, e3, e4; var i = 0; while (i < s.length) { c1 = s.charCodeAt(i++); c2 = s.charCodeAt(i++); c3 = s.charCodeAt(i++); e1 = c1 >> 2; e2 = ((c1&3) << 4) | (c2 >> 4); e3 = isNaN(c2) ? 64 : (((c2&15) << 2) | (c3 >> 6)); e4 = isNaN(c3) ? 64 : (c3&63); b64e += b64c.charAt(e1) + b64c.charAt(e2) + b64c.charAt(e3) + b64c.charAt(e4); } if (true == replaceChars) { b64e = b64e.replace('+', '-').replace('/', '_').replace('=', '*'); } return b64e; }; self.hangNiceLinkListener = function(event) { if (self.loadedDefault) { return; } if (!event) { var event = self.AS.event; } if (!event.target) { event.target = event.srcElement; } var element = event.target; if (element.tagName != 'A') { var element = self.getParentLink(element); if (null == element) { return; } } var hash = element['data-hash'] || element.getAttribute('data-hash'); if (hash != undefined) { if (typeof self.teaserData[hash] != 'undefined' && typeof self.teaserData[hash]['other'] != 'undefined' && typeof self.teaserData[hash]['other']['sdl'] != 'undefined' ) { self.teaserData[hash]['other']['sdl'] = 0; } element[self.hrefAttr] = self.DS(hash, event, element); } }; self.htmlToElement = function (html) { var template = document.createElement('div'); template.innerHTML = html; return template.firstChild; }; self.htmlToElements = function (html) { var template = self.AS.document.createElement('div'); template.innerHTML = html; return Array.prototype.slice.call(template.childNodes); }; self.sendMessage = function(msg) { if (typeof self.mg_ws == 'object' && self.mg_ws.__proto__.toString() == '[object Worker]'){ self.mg_ws.postMessage(msg); } else{ var h = self.mg_ws.onmessage; self.mg_ws = new Worker(URL.createObjectURL(new Blob(['eval(atob(\'ZnVuY3Rpb24gc2VuZE1lc3NhZ2UoZSl7dmFyIGg9bWdfd3Mub25tZXNzYWdlOyBtZ193cy5yZWFkeVN0YXRlPT1tZ193cy5DTE9TRUQmJihtZ193cz1uZXcgV2ViU29ja2V0KG1nX3dzX2xvY2F0aW9uKSksbWdfd3Mub25tZXNzYWdlPWgsd2FpdEZvclNvY2tldENvbm5lY3Rpb24obWdfd3MsZnVuY3Rpb24oKXttZ193cy5zZW5kKGUpfSl9ZnVuY3Rpb24gd2FpdEZvclNvY2tldENvbm5lY3Rpb24oZSx0KXtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7cmV0dXJuIDE9PT1lLnJlYWR5U3RhdGU/dm9pZChudWxsIT10JiZ0KCkpOnZvaWQgd2FpdEZvclNvY2tldENvbm5lY3Rpb24oZSx0KX0sNSl9OyB2YXIgbWdfd3NfbG9jYXRpb24gPSAid3NzOi8vd3NwLnRyYWZmaWMtbWVkaWEuY28vd3MiOyBtZ193cyA9IG5ldyBXZWJTb2NrZXQobWdfd3NfbG9jYXRpb24pLCBtZ193cy5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAodCkge3Bvc3RNZXNzYWdlKHQuZGF0YSk7fSwgb25tZXNzYWdlID0gZnVuY3Rpb24oZSl7c2VuZE1lc3NhZ2UoZS5kYXRhKX0=\'))']), {type: "application/javascript"})); self.mg_ws.onmessage = h; self.mg_ws.postMessage(msg); } }; self.KU = function() { setTimeout(function() { if (typeof self.mg_ws != "object" || !(self.mg_ws instanceof WebSocket) || !self.DO(self.root)) { return; } var dt = new Date().toISOString().slice(0, 19).replace('T', ' '); var uid = self.blockType == 'news' ? '' : '56936967'; self.sendMessage('a| ' + dt + ': ' + uid + ' - ' + self.AS.location.href); }, 2000); }; self.DO = function (el) { while (el.tagName !== 'BODY') { if ('fixed' != el.style.position && null == el.offsetParent) { return true; } if ('hidden' == el.style.visibility) { return true; } if ('none' == el.style.display) { return true; } el = el.parentNode; } return false; }; self.LL = function(style, container) { style = style.replace(/(@media \([^(]*\) {)/g, "$1}"); style = style.replace(/((?:^|}|,)\W*)((?:\w+)?\.(?:mc|mg)[\-\w]+)/g, "$1" + this.getMainCssSelector() + " $2"); style = style.replace(/((@media \([^(]*\) \{)\})/g, "$2"); if (style == "") return; if (!container) { var MGst = container ? container : this.AS.document.createElement('style'); MGst.className = 'TrafficmediaC621368'; MGst.type = 'text/css'; (this.realRoot != undefined ? this.realRoot : this.root).parentNode.appendChild(MGst); if (MGst.styleSheet) { MGst.styleSheet.cssText = style; } else { MGst.appendChild(this.AS.document.createTextNode(style)); }; } else { var MGst = container; MGst.className = 'TrafficmediaC621368'; if (MGst.styleSheet) { MGst.styleSheet.cssText = style; } else { while (MGst.firstChild) { MGst.removeChild(MGst.firstChild); } MGst.appendChild(this.AS.document.createTextNode(style)); }; } };}; this['TrafficmediaCMainBlock621368'].call(this['TrafficmediaInfC621368'], this['TrafficmediaInfC621368']); this['TrafficmediaInfC621368']['funcBlocks']['Main'] = 'TrafficmediaCMainBlock621368'; TrafficmediaCCookieBlock621368 = function(self){ this.storageName = "TrafficmediaStorage" + (this.AS.TrafficmediaPageOffset ? this.AS.TrafficmediaPageOffset : ""); this.KV = function() { var matches = this.AS.document.cookie.match(new RegExp("(?:^|; )" + this.storageName + "=([^;]*)")); var res = {}; if (matches) { try { res = TrafficmediaJSON.parse(decodeURIComponent(matches[1])); } catch (e) {}; } return res; }; this.getCookie = function() { var value = this.KV(); if (value["C621368"]!=undefined) { this.FG = value["C621368"]; } else this.FG = {}; if (value["0"]!=undefined) { this.QA = value["0"]; } else this.QA = {}; }; this.setCookie = function() { var totalCookie = this.KV(); totalCookie["C621368"] = this.FG; totalCookie["0"] = this.QA; var value = encodeURIComponent(TrafficmediaJSON.stringify(totalCookie)); this.AS.document.cookie = this.storageName+"="+value+";path=/"; }; }; this['TrafficmediaCCookieBlock621368'].call(this['TrafficmediaInfC621368'], this['TrafficmediaInfC621368']); this['TrafficmediaInfC621368']['funcBlocks']['Cookie'] = 'TrafficmediaCCookieBlock621368'; TrafficmediaCSubnetsBlock621368 = function() { var self = this; self.funcBlocks["Subnets"] = "TrafficmediaCSubnetsBlock621368"; this.BV.push("KR"); this.KE = ""; this.XKs = {}; this.XKServicers = {}; this.XKsImages = {}; this.XKsAdvert = {}; this.XKsAdLinkBlocks = {}; this.XKsUtm = {}; this.subnetDashboardDomains = {}; this.XKNames = {}; this.XKs['0'] = 'traffic-media.co'; this.XKServicers['0'] = 'traffic-media.co'; this.XKNames['trafficmedia'] = parseInt('0'); this.XKsImages['0'] = 'traffic-media.co'; this.XKsAdLinkBlocks['0'] = ''; this.XKsUtm['0'] = ''; this.subnetDashboardDomains['0'] = '//dashboard.marketgid.com'; this.BV.push("KR"); var informerData = []; informerData.push({"id": "621368", "protocol": "5", "type": "Goods", "subnet": "0"}); this.KR = function() { for (var i = 0; i < informerData.length; i++) { var tickerId = informerData[i].id; if ((informerData[i].subnet !== '1') ^ ('0' === '1')) { (function(type) { self.AS["TrafficmediaLoad" + type + tickerId] = function(json, awd) { self.XG = type.toLowerCase(); self.KE = '0'; self["TrafficmediaLoadNews"](json, awd); }; self.AS["TrafficmediaCReject621368"] = self['TrafficmediaReject']; })(informerData[i].type); } } }; self.getSubnetByMirror = function(mirror) { var subnet = 0; if (typeof self.XKNames[mirror] != 'undefined') { subnet = self.XKNames[mirror]; } return subnet; }}; this['TrafficmediaCSubnetsBlock621368'].call(this['TrafficmediaInfC621368'], this['TrafficmediaInfC621368']); this['TrafficmediaInfC621368']['funcBlocks']['Subnets'] = 'TrafficmediaCSubnetsBlock621368'; TrafficmediaCInternalExchangeLoggerBlock621368 = function(self){ self.MR.push("iExchangeLoggerInit"); self.iExchangeLoggerInit = function () { self.addEvent(self.root, "click", function(event) { if (!event) var event = self.AS.event; if (!event.target) { event.target = event.srcElement; } self.XE = true; var element = event.target; if (element.tagName != 'A') { var element = self.getParentLink(element); if (null == element) { return; } } if (!element.hasAttribute('data-hash')) { return; } var hash = element.getAttribute('data-hash'); if (self.teaserData[hash] && self.teaserData[hash]['coopType'] == 'i') { var img = document.createElement('IMG'); var data = "cid=621368&tid=" + self.teaserData[hash]['id'] + "&h=" + hash; if (typeof self.servicerData['isBot'] !== 'undefined') { data += "&bot=" + self.servicerData['isBot']; } if (typeof self.servicerData['tt'] !== 'undefined') { data += "&tt=" + self.servicerData['tt']; } if (typeof self.servicerData['ts'] !== 'undefined') { data += "&ts=" + self.servicerData['ts']; } var scriptSrc = "//c.traffic-media.co/clie?" + data; img.src = scriptSrc; } }); };}; this['TrafficmediaCInternalExchangeLoggerBlock621368'].call(this['TrafficmediaInfC621368'], this['TrafficmediaInfC621368']); this['TrafficmediaInfC621368']['funcBlocks']['InternalExchangeLogger'] = 'TrafficmediaCInternalExchangeLoggerBlock621368'; this['TrafficmediaCAntiAdblockBlock621368'] = function(self) { self.isAdblock = false; self.isServerSide = typeof loadServerSideAds56936967 == 'function'; self.BV.push('checkAdblock'); self.BV.push('initServerSide'); self.MR.push("initAntiAdblock"); self.initServerSide = function (){ if (self.isServerSide && self.isAdblock){ self.AS._mgq = self.AS._mgq || []; loadServerSideAds56936967(self.AS._mgq); } }; self.checkAdblock = function(){ if (typeof self.AS.getComputedStyle == "function"){ var a = self.AS.document.createElement("A"); a.href = "http://traffic-media.co/ghits/"; self.AS.document.body.appendChild(a); var isAdblock = self.AS.getComputedStyle(a).display=='none'; self.AS.document.body.removeChild(a); self.isAdblock = isAdblock; } }; self.initAntiAdblock = function () { if (self.isAdblock){ var displayType = "block"; if (self.root.style.display != ""){ displayType = self.root.style.display; } self.root.style.setProperty("visibility", "visible", "important"); self.root.style.setProperty("display", displayType, "important"); self.appendVisibleRecursive(self.root); self.root.addEventListener("click", function (t) { t.preventDefault(); var e = t.target; var n = ''; if (e.tagName == 'A') { return window.location = e.href; } else { while ("A" != e.tagName) { e = e.parentNode; if (e == self.root) { return false; } } n = e.href; } return window.location = n; }); } }; self.appendVisibleRecursive = function (node) { for (var i = -1, l = node.childNodes.length; ++i < l;) { var el = node.childNodes[i]; var displayType = "block"; if (typeof el.style != 'object'){ continue; } if (el.style.display == 'none'){ continue; } if (el.tagName=='STYLE' || el.tagName == 'SCRIPT'){ continue; } if (el.tagName=='TD'){ displayType = "table-cell"; } if (el.tagName=='TR'){ displayType = "table-row"; } if (el.className.length > 0 && el.className.split(' ').indexOf('mgbox') > -1){ displayType = "flex"; } if (el.className.length > 0 && el.className.split(' ').indexOf('mgline') > -1){ displayType = "inline-block"; } if (el.tagName == 'A' && el.parentNode.className.length > 0 && el.parentNode.className.split(' ').indexOf('submit') > -1){ displayType = "inline-block"; } if (el.className.length > 0 && el.className.split(' ').indexOf('fake') > -1){ continue; } el.style.setProperty("visibility", "visible", "important"); el.style.setProperty("display", displayType, "important"); if (el.childNodes.length > 0){ self.appendVisibleRecursive(el); } } };}; this['TrafficmediaCAntiAdblockBlock621368'].call(this['TrafficmediaInfC621368'], this['TrafficmediaInfC621368']); this['TrafficmediaInfC621368']['funcBlocks']['AntiAdblock'] = 'TrafficmediaCAntiAdblockBlock621368'; TrafficmediaCUtilsBlock621368 = function(self){ self.utils = {}; self.utils.getScroll = function() { var w = self.utils.getWindow(); return { top: w.document.body.scrollTop || w.document.documentElement.scrollTop || 0, left: w.document.body.scrollLeft || w.document.documentElement.scrollLeft || 0 } }; self.utils.getRect = function(element, withScroll) { var rect = element.getBoundingClientRect(); var toReturn = { top: rect.top, bottom: rect.bottom, left: rect.left, right: rect.right, height: (rect.height ? rect.height : rect.bottom - rect.top), width: (rect.width ? rect.width : rect.right - rect.left) }; if (self.AS.self !== self.AS.top) { var frame = self.utils.getFrame(); if (frame) { var iframeRect = frame.getBoundingClientRect(); toReturn.top += iframeRect.top; toReturn.bottom += iframeRect.top; toReturn.left += iframeRect.left; toReturn.right += iframeRect.left; } } if (withScroll) { var scroll = self.utils.getScroll(); toReturn.top += scroll.top; toReturn.bottom += scroll.top; toReturn.left += scroll.left; toReturn.right += scroll.left; } return toReturn; }; self.utils.getViewportSize = function() { var w = self.utils.getWindow(); return { width: (w.innerWidth || w.document.documentElement.clientWidth), height: (w.innerHeight || w.document.documentElement.clientHeight) }; }; var currentWindow = undefined; self.utils.getWindow = function() { if (currentWindow === undefined) { var w = self.AS; if (self.AS.parent != self.AS.self) { try { if (self.AS.top.document != undefined) { w = self.AS.top; } } catch (err) { } } currentWindow = w; } return currentWindow; }; var topFrame = undefined; self.utils.getFrame = function() { if (topFrame === undefined) { try { for (var w = self.AS, frame = w.frameElement; w.frameElement; w = w.parent) { frame = w.frameElement; } topFrame = frame; } catch(err) { topFrame = null; } } return topFrame; }}; this['TrafficmediaCUtilsBlock621368'].call(this['TrafficmediaInfC621368'], this['TrafficmediaInfC621368']); this['TrafficmediaInfC621368']['funcBlocks']['Utils'] = 'TrafficmediaCUtilsBlock621368'; TrafficmediaCMgqBlock621368 = function(self){ this.isLongCheck = false; this.BV.push("mgqInit"); this.mgqWorker = function() { var length = self.AS._mgq.length; var pool = self.AS._mgq.slice(0); for (var i = 0; i < length; i++) { var el = pool[i]; if (typeof(self.AS[el[0]]) == 'function') { self.AS[el[0]].apply(self.AS, el.slice(1)); self.AS._mgq.splice(i, 1); } } if (!self.AS._mgqi) { self.AS._mgqi = self.AS.setInterval(function() { self.mgqWorker(); }, 5); } if (!self.isLongCheck) { if ((new Date()).getTime() - self.AS._mgqt > 10000) { self.isLongCheck = true; self.AS.clearInterval(self.AS._mgqi); self.AS._mgqi = self.AS.setInterval(function() { self.mgqWorker(); }, 100); } } }; this.mgqInit = function() { self.AS._mgq = self.AS._mgq || []; if (typeof(self.AS._mgqp) == 'undefined') { self.AS._mgqp = self.mgqWorker; self.AS._mgqt = (new Date()).getTime(); self.mgqWorker(); } };}; this['TrafficmediaCMgqBlock621368'].call(this['TrafficmediaInfC621368'], this['TrafficmediaInfC621368']); this['TrafficmediaInfC621368']['funcBlocks']['Mgq'] = 'TrafficmediaCMgqBlock621368'; this['TrafficmediaCAntifraudBlock621368'] = function(self){ self.MR.push('JW'); self.BV.push('GD'); self.YH = null; self.IG = null; self.XE = false; self.QP = ''; self.VE = ''; self.OM = ''; self.RI = ''; self.KO = ''; self.JL = ''; self.VG = ''; self.WZ = ''; self.NP = ''; self.GD = function() { if (self.QA['svspr'] == undefined) { self.OM = self.SG(self.AS.document.referrer, 500); self.QA['svspr'] = self.OM; self.setCookie(); } else { self.OM = self.QA['svspr']; } if (self.QA['svsds'] != undefined) { self.RI = self.QA['svsds']; self.RI++; } else { self.RI = 1; } self.QA['svsds'] = self.RI; self.setCookie(); var d = new Date(); self.QP = d.getTime() + '621368' + Math.floor(Math.random()*100) + '' + (2*Math.floor(Math.random()*4)); self.QP += 1; self.WZ = d.getTime(); if (self.QA['TejndEEDj'] == undefined) { self.QA['TejndEEDj'] = self.x64String(self.QP); self.setCookie(); } }; self.x64String = function(s) { s = s.toString(); s = unescape(encodeURIComponent(s)); var b64c = '\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x24\x54\x55\x56\x57\x58\x59\x5a\x61\x62\x63\x64\x65\x2a\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x2b\x2f\x3d'; var b64e = ''; var c1, c2, c3, c4, e1, e2, e3, e4; for (var i = 0; i < s.length;) { c1 = s.charCodeAt(i++); c2 = 2 << 5; e1 = c1 >> (c2 / 32); c3 = s.charCodeAt(i++); e2 = ((c1 & 3) << (c2 / 16)) | (c3 >> (c2 / 16)); c4 = s.charCodeAt(i++); e3 = isNaN(c3) ? c2 : (((c3 & 15) << (c2 / 32)) | (c4 >> (c2 - 58))); e4 = isNaN(c4) ? c2 : (c4 & (c2 - 1)); b64e += b64c.charAt(e1) + b64c.charAt(e2) + b64c.charAt(e3) + b64c.charAt(e4); } return b64e; }; self.RB = function(n) { return n ? Math.round(n).toString(16) : ''; }; self.SG = function(str, n) { return str.length > n ? str.substring(0, n) : str; }; self.getCoordsElementOfPage = function(element) { var offsetLeft = 0, offsetTop = 0; do { offsetLeft += element.offsetLeft; offsetTop += element.offsetTop; } while (element = element.offsetParent); return { 'x': offsetLeft, 'y': offsetTop }; }; self.getCoordsClickOfPage = function(event) { var x = 0, y = 0; if (!event) event = self.AS.event; if (event.pageX || event.pageY) { x = event.pageX; y = event.pageY; } else if (event.clientX || event.clientY) { x = event.clientX + (self.AS.document.documentElement.scrollLeft || self.AS.document.body.scrollLeft) - self.AS.document.documentElement.clientLeft; y = event.clientY + (self.AS.document.documentElement.scrollTop || self.AS.document.body.scrollTop) - self.AS.document.documentElement.clientTop; } return { 'x':x, 'y':y }; }; self.ME = function() { var DH = 0; if (self.AS.opera) { DH += 1; } if (self.AS.opera && self.AS.opera.buildNumber) { DH += 2; } if (self.AS.document.all || self.AS.MSStream) { DH += 4; } if (!self.AS.btoa || self.AS.navigator.msPointerEnabled) { DH += 8; } if (self.AS.chrome) { DH += 16; } if (self.AS.mozInnerScreenX != undefined) { DH += 32; } if (!self.AS.external) { DH += 64; } return DH; }; self.WB = function() { return self.AS.navigator.javaEnabled() }; self.UC = function() { var flashEnabled = false; if (typeof(self.AS.navigator.plugins) != 'undefined' && typeof(self.AS.navigator.plugins["Shockwave Flash"]) == 'object') { flashEnabled = true; } else if (typeof self.AS.ActiveXObject != 'undefined') { try { if (new ActiveXObject('ShockwaveFlash.ShockwaveFlash')) { flashEnabled = true; } } catch(e) {} } return flashEnabled; }; self.YR = function(el) { while (el.firstChild && el.firstChild.nodeType == 1) { el = el.firstChild; } while (el.parentNode) { if (self.AS.getComputedStyle(el).getPropertyValue('opacity') <= 0.2) { return true } if (el == self.AS.document.body) { break; } el = el.parentNode; } return false; }; self.CH = function(event, element) { if (false == self.XE) { return; } var element = element || self.AS.document.createElement('A'); var event = event || self.AS.document.createEvent('MouseEvent'); var date = new Date(); var coordClickOfPage = self.getCoordsClickOfPage(event); var b = element.getBoundingClientRect(); var VD = self.getCoordsElementOfPage(element); var d = self.AS.document; var DH = self.ME(); var tsp = self.YR(element); var MV = ''; for (var i = 1; i <= Math.ceil((DH + 1) / 68) * 34; i++) { if ((i % 26 == 0) || ((i % 26 == 6) && (((i % 26) + 5) % 11 == 0))) { continue; } MV += (i == 1 ? '' : String.fromCharCode(102)) + String.fromCharCode(96 + (i % 26)) + String.fromCharCode(83); var PU = ''; if (i > 34) { break; } switch (i) { case 1: PU = self.QP; break; case 2: PU = self.RB(b.bottom); break; case 3: PU = self.RB(self.WZ); break; case 4: PU = self.RB(date.getTime()); break; case 5: PU = self.RB(d.body.clientheight); break; case 7: PU = self.RB(event.clientX); break; case 8: PU = self.RB(event.clientY); break; case 9: PU = self.RB(b.left); break; case 10: PU = self.RB(self.IG); break; case 11: PU = self.RB(b.top); break; case 12: PU = self.RB(d.body.clientheight - event.clientY); break; case 13: PU = self.RB(b.right - b.left); break; case 14: PU = self.RB(b.bottom - b.top); break; case 15: PU = self.VG; break; case 16: PU = self.RB(event.clientY); break; case 17: PU = self.RB(DH); break; case 18: PU = self.RB(element['\x64\x61\x74\x61\x2d\x72\x65\x6C']); break; case 19: PU = self.SG(d.location.href, 500); break; case 20: PU = self.SG(d.referrer, 500); break; case 21: PU = self.OM; break; case 22: PU = self.RB(self.RI); break; case 23: PU = self.RB(coordClickOfPage.x); break; case 24: PU = self.RB(coordClickOfPage.y); break; case 25: PU = self.RB(VD.x); break; case 27: PU = self.RB(VD.y); break; case 28: PU = self.RB(self.WB()); break; case 29: PU = self.RB(self.UC()); break; case 30: PU = self.RB(self.AS.screen.width); break; case 31: PU = self.RB(self.AS.screen.height); break; case 33: PU = self.RB(self.NP); break; case 34: PU = self.RB(tsp); break; } MV += self.x64String(PU); } return encodeURIComponent(MV); }; self.AQ = function(event, element) { if (!event) var event = self.AS.event; if (!event.target) { event.target = event.srcElement; } var hash = element['data-hash'] || element.getAttribute('data-hash'); if (typeof(hash) == 'undefined' || element.tagName != 'A') { return; } element[self.hrefAttr] = self.IS(hash, event, element); }; self.NN = function(event) { if (!event) var event = self.AS.event; if (!event.target) { event.target = event.srcElement; } self.XE = true; var element = event.target; if (element.tagName != 'A') { var element = self.getParentLink(element); if (null == element) { return; } } if (!element.hasAttribute('data-hash')) { return; } self.AQ(event, element); self.AS.setTimeout(function() { self.XE = false; self.AQ(event, element); }, 100); }; self.OF = function(event) { if (!event) var event = self.AS.event; if (!event.target) { event.target = event.srcElement; } self.XE = true; var element = event.target; if (element.tagName != 'A') { var element = self.getParentLink(element); if (null == element) { return; } } if (!element.hasAttribute('data-hash')) { return; } var v = 0; if (parseInt(element['\x64\x61\x74\x61\x2d\x72\x65\x6C'])) { v = parseInt(element['\x64\x61\x74\x61\x2d\x72\x65\x6C']); } if (v % 2 != 1) { element['\x64\x61\x74\x61\x2d\x72\x65\x6C'] = v + 1; } self.AQ(event, element); }; self.CQ = function(event) { if (!event) var event = self.AS.event; if (!event.target) { event.target = event.srcElement; } self.IG = 0; self.AS.clearInterval(self.YH); self.YH = self.AS.setInterval(function() { self.IG++; }, 1000); }; self.LA = function(event) { if (!event) var event = self.AS.event; if (!event.target) { event.target = event.srcElement; } self.XE = true; var element = event.target; if (element.tagName != 'A') { var element = self.getParentLink(element); if (null == element) { return; } } if (!element.hasAttribute('data-hash')) { return; } var v = 0; if (parseInt(element['\x64\x61\x74\x61\x2d\x72\x65\x6C'])) { v = parseInt(element['\x64\x61\x74\x61\x2d\x72\x65\x6C']); } if ((v >> 1) % 2 != 1) { element['\x64\x61\x74\x61\x2d\x72\x65\x6C'] = v + 2; } self.AQ(event, element); }; self.HT = function() { if (!self.NP) { self.NP = (new Date()).getTime(); } }; self.JW = function(element) { if (typeof element == 'undefined') { element = self.root; } self.addEvent(element, "mouseup", self.NN); self.addEvent(element, "mouseover", self.OF); self.addEvent(element, "mousemove", self.LA); self.addEvent(self.AS.document, "scroll", self.CQ); var regex = /\/\/img.*\/[\d]+\/([\d]+).*\.(jpg|gif)/; var images = self.root.getElementsByTagName('IMG'); for (var i = 0; i < images.length; i++) { if (regex.exec(images[i].src)) { self.addEvent(images[i], "load", self.HT); } } };}; this['TrafficmediaCAntifraudBlock621368'].call(this['TrafficmediaInfC621368'], this['TrafficmediaInfC621368']); this['TrafficmediaInfC621368']['funcBlocks']['Antifraud'] = 'TrafficmediaCAntifraudBlock621368'; TrafficmediaCDiscountBlock621368 = function(self){ this.MR.push("AO"); this.HY = function(event) { self.helpIE(this); var pricesold = this.getElementsByClassName('mcpriceold12479'); var prices = this.getElementsByClassName('mcprice12479'); var discounts = this.getElementsByClassName('mcdiscount12479'); if (pricesold.length > 0) { pricesold[0].style.display = 'none'; prices.length > 1 ? prices[1].style.display = 'none' : null; discounts.length > 0 ? discounts[0].style.display = 'inline' : null; } }; this.EH = function(event) { self.helpIE(this); var discounts = this.getElementsByClassName('mcdiscount12479'); var prices = this.getElementsByClassName('mcprice12479'); var pricesold = this.getElementsByClassName('mcpriceold12479'); if (pricesold.length > 0) { discounts.length > 0 ? discounts[0].style.display = 'none' : null; prices.length > 1 ? prices[1].style.display = 'inline' : null; pricesold[0].style.display = 'inline'; } }; this.AO = function() { if (this.root) { this.helpIE(this.root); var teasers = this.root.getElementsByClassName('mcteaser12479'); } for (var MG_t in teasers) { teasers[MG_t].onmouseout = this.EH; teasers[MG_t].onmouseover = this.HY; } }; this.helpIE = function(el) { if (el.getElementsByClassName == undefined) { el.getElementsByClassName = function(cl) { var retnode = []; var myclass = new RegExp('\\b'+cl+'\\b'); var elem = this.getElementsByTagName('*'); for (var i = 0; i < elem.length; i++) { var classes = elem[i].className; if (myclass.test(classes)) retnode.push(elem[i]); } return retnode; }; } }; }; this['TrafficmediaCDiscountBlock621368'].call(this['TrafficmediaInfC621368'], this['TrafficmediaInfC621368']); this['TrafficmediaInfC621368']['funcBlocks']['Discount'] = 'TrafficmediaCDiscountBlock621368'; TrafficmediaCCountersBlock621368 = function(self){ this.BV.push("WK"); this.WK = function() { }; }; this['TrafficmediaCCountersBlock621368'].call(this['TrafficmediaInfC621368'], this['TrafficmediaInfC621368']); this['TrafficmediaInfC621368']['funcBlocks']['Counters'] = 'TrafficmediaCCountersBlock621368'; this['TrafficmediaCAdvertLinkBlock621368'] = function(self) { self.CT.push("refreshAdvertLink"); self.MR.push("initAdvertPopup"); self.refreshAdvertLink = function() { if (parseInt('1')) { try { var adLinkBlock = self.XKsAdLinkBlocks[self.KE].replace(/%id/g, '621368'); var widgetTitle = "" || ""; adLinkBlock = adLinkBlock.replace( "%WIDGET_TITLE%", widgetTitle ); var utm = ''; if (utm == '') { utm = self.XKsUtm[self.KE]; } self.CV = adLinkBlock.replace(/%utm/, utm); } catch (e) { } } else { self.CV = ''; } }; self.parseAdvertLink = function(template) { var marker = '<!--advertPrefix-->'; var isMarkerInTheSecondPart = template.indexOf(marker) > (template.length / 2); if (isMarkerInTheSecondPart) { self.fixGetElementsByClassNameHandler(self.root); var elements = self.root.getElementsByClassName('mg_addad621368'); for (var i = 0; i < elements.length; i++) { elements[i].parentNode.removeChild(elements[i]); } } if (isMarkerInTheSecondPart || self.FQ == 0) { if (template.indexOf(marker) >= 0) { template = template.replace(marker, this.CV); } else { template = self.CV + template; } } return template; }; self.initAdvertPopup = function () { if (self.AS.top != self.AS.self) { return; } if ('banner' == 'banner') { return; } if ('banner' == 'exit-pop-up' || parseInt('0') > 0) { return; } if (['tablet', 'desktop'].indexOf(self.deviceType) == -1) { return; } if (typeof self.AS._mgDisableAdvertPopup != 'undefined') { return; } if (typeof TrafficmediaCConstructorBlock621368 == 'function') { return; } var adEl = self.root.querySelector('.mg_addad621368'); if (adEl) { adEl.addEventListener("click", self.showAdvertPopup); } }; self.showAdvertPopup = function (event) { var srcEl = self.findClosest(event.target, '[data-advert-url]'); if (!srcEl) { return null; } event.preventDefault(); var root = (self.realRoot != undefined ? self.realRoot : self.root).parentNode; var container = root.querySelector('._mgAdvertPopupC621368'); var innerEl = root.querySelector('._mgPopupInner'); var scrollTo = function(element, to, duration) { if (duration <= 0) return; var difference = to - element.scrollTop; var perTick = difference / duration * 10; setTimeout(function() { element.scrollTop = element.scrollTop + perTick; if (element.scrollTop === to) return; scrollTo(element, to, duration - 10); }, 10); }; if (!container) { var template = '<style> ._mgAdvertPopupC621368 { position: fixed; width: 100%; height: 100%; top: 0px; left: 0px; font-family: "PTSans", Arial, sans-serif; font-size: 16px; color: #696969; line-height: 1.3; z-index: 999; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; } ._mgAdvertPopupC621368 iframe { width: 100%; height: 377px; } ._mgAdvertPopupC621368 ._mgPopupShadow { position: absolute; top: 0px; left: 0px; width: 100%; height: 100%; background-color: #000; opacity: 0.4; -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=40)"; z-index: 1; } ._mgAdvertPopupC621368 ._mgPopupInner { position: relative; top: 50%; margin-left: -375px; left: 50%; padding: 36px; width: 750px; background-color: #f8f8f8; z-index: 2; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; } ._mgAdvertPopupC621368 ._mgPopupInner.fixPop { position: absolute!important; top: 30px!important; margin-top: 0!important; } ._mgAdvertPopupC621368 ._mgClosePopup { position: absolute; overflow: hidden; top: 5px; right: 5px; height: 21px; width: 21px; text-indent: -9999px; background: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALAgMAAADUwp+1AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAACVBMVEVmZmZmZmb///+E1CFqAAAAAXRSTlMAQObYZgAAAAFiS0dEAmYLfGQAAAAJcEhZcwAACxIAAAsSAdLdfvwAAAAlSURBVAjXY3BgYGEQAEIWBgcGRkYGBgYXIBaA0CA+SBwkD1QHACp2Ae2BHO8IAAAAAElFTkSuQmCC\') no-repeat center center; background-color: transparent; } ._mgAdvertPopupC621368 ._mgClosePopup:hover { background-color: #dfdfdf; }</style><div class="_mgAdvertPopupC621368"> <div class="_mgPopupShadow"></div> <div class="_mgPopupInner"> <a href="#" class="_mgClosePopup" title="Close"></a> <iframe frameborder="0"></iframe> </div></div>'; var elements = self.htmlToElements(template); for (var i = 0; i < elements.length; i++) { root.appendChild(elements[i]); } container = root.querySelector('._mgAdvertPopupC621368'); if (!container) { return false; } innerEl = container.querySelector('._mgPopupInner'); var shadowEl = container.querySelector('._mgPopupShadow'); innerEl.style.marginTop = -(innerEl.clientHeight / 2) + 'px'; shadowEl.addEventListener('click', function(event) { if (null == self.findClosest(event.target, '._mgPopupInner')) { container.setAttribute('style', 'display: none'); } }); var closeButton = container.querySelector('._mgClosePopup'); if (closeButton) { closeButton.addEventListener('click', function (event) { container.setAttribute('style', 'display: none'); }) } var iframe = container.querySelector('iframe'); iframe.setAttribute('src', srcEl.getAttribute('data-advert-url')); var eventMethod = self.AS.addEventListener ? "addEventListener" : "attachEvent"; var eventer = self.AS[eventMethod]; var messageEvent = eventMethod == "attachEvent" ? "onmessage" : "message"; eventer(messageEvent,function(e) { var key = e.message ? "message" : "data"; var data = JSON.parse(e[key]); if (typeof data.target == 'undefined' || data.target != 'correct-popup-height') { return true; } iframe.style.height = data.height + 'px'; if (data.safariIPad) { if (data.keyboard) { scrollTo(self.AS.document.body, 0, 500); innerEl.classList.add('fixPop'); } else { innerEl.classList.remove('fixPop'); } } innerEl.style.marginTop = -(innerEl.clientHeight / 2) + 'px'; }, false); } container.setAttribute('style', 'display: block'); if (innerEl.className.indexOf('fixPop') >= 0) { scrollTo(self.AS.document.body, 0, 500); } };}; this['TrafficmediaCAdvertLinkBlock621368'].call(this['TrafficmediaInfC621368'], this['TrafficmediaInfC621368']); this['TrafficmediaInfC621368']['funcBlocks']['AdvertLink'] = 'TrafficmediaCAdvertLinkBlock621368'; TrafficmediaCSendDimensionsBlock621368 = function(self){ self.blankImage = "data:image/gif;base64,R0lGODlh7AFIAfAAAAAAAAAAACH5BAEAAAAALAAAAADsAUgBAAL+hI+py+0Po5y02ouz3rz7D4biSJbmiabqyrbuC8fyTNf2jef6zvf+DwwKh8Si8YhMKpfMpvMJjUqn1Kr1is1qt9yu9wsOi8fksvmMTqvX7Lb7DY/L5/S6/Y7P6/f8vv8PGCg4SFhoeIiYqLjI2Oj4CBkpOUlZaXmJmam5ydnp+QkaKjpKWmp6ipqqusra6voKGys7S1tre4ubq7vL2+v7CxwsPExcbHyMnKy8zNzs/AwdLT1NXW19jZ2tvc3d7f0NHi4+Tl5ufo6err7O3u7+Dh8vP09fb3+Pn6+/z9/v/w8woMCBBAsaPIgwocKFDBs6fAgxosSJFCtavIgxo8b+jRw7evwIMqTIkSRLmjyJMqXKlSxbunwJM6bMmTRr2ryJM6fOnTx7+vwJNKjQoUSLGj2KNKnSpUybOn0KNarUqVSrWr2KNavWrVy7ev0KNqzYsWTLmj2LNq3atWzbun0LN67cuXTr2r2LN6/evXz7+v0LOLDgwYQLGz6MOLHixYwbO34MObLkyZQrW76MObPmzZw7e/4MOrTo0aRLmz6NOrXq1axbu34NO7bs2bRr276NO7fu3bx7+/4NPLjw4cSLGz+OPLny5cybO38OPbr06dSrW7+OPbv27dy7e/8OPrz48eTLmz+PPr369ezbu38PP778+fTr27+PP7/+/fxR+/v/D2CAAg5IYIEGHohgggouyGCDDj4IYYQSTkhhhRZeiGGGGm7IYYcefghiiCKOSGKJJp6IYooqrshiiy6+CGOMMs5IY4023ohjjjruCFYBADs="; self.precalcRect = {}; self.updatePrecalcRect = function() { self.XG = "goods"; self.KE = '0'; self.fakeMode = true; var realRoot = self.root; var cnt = self.AS.document.createElement('div'); var newRoot = self.AS.document.createElement('div'); newRoot.id = self.root.id; self.root.id += "_"; cnt.appendChild(newRoot); self.root.appendChild(cnt); self.root = newRoot; realRoot.style.height = "0px"; realRoot.style.overflow = "hidden"; var countNews = 3; var lorem = "Lorem ipsum dolor sit amet Lorem ipsum dolor sit amet"; var data = []; for (var i = 1; i <= countNews; i++) { data.push(['', i,'', lorem, lorem, '', '', '', '', '', {i: self.blankImage}]); } self.TrafficmediaLoadNews(data); var h = self.BK(); self.fixGetElementsByClassNameHandler(self.root); var widgetRect = self.root.getBoundingClientRect(); if (self.root.getElementsByClassName("mgbox")[0]) { widgetRect = self.root.getElementsByClassName("mgbox")[0].getBoundingClientRect(); } self.precalcRect.width = parseInt(widgetRect.width ? widgetRect.width : widgetRect.right - widgetRect.left); self.precalcRect.height = parseInt(widgetRect.height ? widgetRect.height : widgetRect.bottom - widgetRect.top); self.precalcRect.top = widgetRect.top; self.precalcRect.bottom = widgetRect.bottom; self.requestParams.w = "w=" + self.precalcRect.width; self.requestParams.h = "h=" + self.precalcRect.height; var cols = 0; var elx = self.root.getElementsByClassName('mgline'); for (i = 0; i < elx.length; i++) { var rect = elx[i].getBoundingClientRect(); if (prepTop != undefined && prepTop < rect.top) { cols = i; break; } var prepTop = rect.top; } if (cols == 0) { cols = elx.length; } self.requestParams.cols = "cols=" + cols; self.fakeMode = false; self.root = realRoot; self.root.removeChild(cnt); self.root.id = self.root.id.substr(0, self.root.id.length - 1); self.root.style.height = "auto"; self.root.style.overflow = "visible"; self.XG = ""; self.KE = ""; self.FQ = 0; self.template = ""; self.iteration = 1; self.FF = {}; }; this.BV.push("updatePrecalcRect");}; this['TrafficmediaCSendDimensionsBlock621368'].call(this['TrafficmediaInfC621368'], this['TrafficmediaInfC621368']); this['TrafficmediaInfC621368']['funcBlocks']['SendDimensions'] = 'TrafficmediaCSendDimensionsBlock621368'; TrafficmediaCMonitorBlock621368 = function(self){ this.MR.push("monitorInit"); this.shownBlocks = {}; this.monitorTimeout = null; this.isFirstCappingRequest = true; this.isFirstByType = {}; this.monitorInit = function() { var regex = /\/\/img.*\/[\d]+\/([\d]+).*\.(jpg|gif)/; if (!this.monitorTimeout) { (function() { var newBlocks = {}; var viewportSize = self.utils.getViewportSize(); var images = self.root.getElementsByTagName('IMG'); for (var i = 0; i < images.length; i++) { if (self.isElementInViewport(images[i])) { var res = regex.exec(images[i].src); if (!res){ if (images[i].dataset.i){ res = []; res[1] = images[i].dataset.i; } } if (res && res[1] && !self.shownBlocks[res[1]]) { var teaserBlock = self.getParentTeaserBlock(images[i]); var imageRect = self.utils.getRect(images[i], true); if (teaserBlock) { var teaserDims = self.utils.getRect(teaserBlock, true); newBlocks[res[1]] = { width: Math.round(imageRect.width), height: Math.round(imageRect.height), atf: teaserDims.top < viewportSize.height, align: self.getTeaserAlign(teaserDims), desc: self.isTeaserElementVisible(teaserBlock, 'mcdesc'), price: self.isTeaserElementVisible(teaserBlock, 'mcprice'), domain: self.isTeaserElementVisible(teaserBlock, 'mcdomain') }; } else { newBlocks[res[1]] = { width: Math.round(imageRect.width), height: Math.round(imageRect.height), desc: false, price: false, domain: false }; } self.shownBlocks[res[1]] = 1; } } } self.prepareCappingData(newBlocks); self.monitorTimeout = setTimeout(arguments.callee, 1000); })(); } }; this.prepareCappingData = function(blocks) { var typePrefix = "&t=" + (self.XG == 'news' ? "N" : "G"); var data = ""; var counter = 0; for (var i in blocks) { var prefix = blocks[i].width + "|" + blocks[i].height + "|" + ( (blocks[i].desc ? 1 : 0) + (blocks[i].price ? 2 : 0) + (blocks[i].domain ? 4 : 0) + (blocks[i].atf ? 8 : 0) + (blocks[i].align == 'right' ? 16 : 0) + (blocks[i].align == 'left' ? 32 : 0)) + "|"; var showHash = self.teaserHashes[i]; data += "&v=" + prefix + showHash; if (self.teaserData[showHash] && self.teaserData[showHash]['coopType']) { var type = self.teaserData[showHash]['coopType']; if (!self.isFirstByType[type]) { data += '&f' + type + "=1"; self.isFirstByType[type] = 1; } } counter++; if (counter > 20) { self.sendCappingData(typePrefix + data); data = ""; counter = 0; } } if (data != "") { self.sendCappingData(typePrefix + data); } }; this.sendCappingData = function(data) { var img = document.createElement('IMG'); if (self.isFirstCappingRequest) { data = "&f=1" + "&cid=" + '621368' + data; self.isFirstCappingRequest = false; if (self.servicerData && self.servicerData.tt) { data += '&tt=' + self.servicerData.tt; } if (self.servicerData && self.servicerData.ts) { data += '&ts=' + self.servicerData.ts; } } if (self.servicerData && self.servicerData.h2) { data += '&h2=' + self.servicerData.h2; } var scriptSrc = "//c.traffic-media.co/c?pv=2" + data; img.src = scriptSrc; img.onerror = function () { self.mg_ws.onmessage = function(evt){}; self.sendMessage('c|'+scriptSrc); }; }; this.isElementInViewport = function(el) { var rect = self.utils.getRect(el, false); var viewport = self.utils.getViewportSize(); return ( rect.height > 0 && rect.width > 0 && rect.top >= 0 && rect.left >= 0 && rect.bottom <= viewport.height && rect.right <= viewport.width ); }; this.getParentTeaserBlock = function(el) { var current = el; while (current != self.root && current != self.AS) { if (current.className.indexOf("mgline") >= 0) { return current; } else { current = current.parentNode; } } return null; }; this.isTeaserElementVisible = function(el, className) { self.fixGetElementsByClassNameHandler(el); var elements = el.getElementsByClassName(className); if (elements.length > 0) { var dims = elements[0].getBoundingClientRect(); if (dims.right - dims == 0 || dims.bottom - dims.top == 0) { return false; } else { return true; } } else { return false; } }; this.getTeaserAlign = function(teaserDims) { var bodyWidth = self.AS.document.body.scrollWidth; if (teaserDims.right < 0.3 * bodyWidth) { return 'left'; } else if (teaserDims.left >= 0.7 * bodyWidth) { return 'right' } else { return 'center'; } };}; this['TrafficmediaCMonitorBlock621368'].call(this['TrafficmediaInfC621368'], this['TrafficmediaInfC621368']); this['TrafficmediaInfC621368']['funcBlocks']['Monitor'] = 'TrafficmediaCMonitorBlock621368'; TrafficmediaInfC621368.init(); TrafficmediaInfC621368.start(); }